{
  "version": 3,
  "sources": ["../src/api.ts"],
  "sourcesContent": ["import { ExtensionAPI, SongAPIOptions, Song } from \"./types\";\n\nexport interface MoosyncExtensionTemplate {\n  onStarted: () => Promise<void>;\n}\n\nlet LISTENERS: Record<string, Function> = {};\n\nfunction camelToPascal(camelCaseStr: string) {\n  // Capitalize the first character and concatenate with the rest of the string\n  return camelCaseStr.charAt(0).toUpperCase() + camelCaseStr.slice(1);\n}\n\nexport const api: ExtensionAPI = new Proxy({} as ExtensionAPI, {\n  get: (_target, prop, _receiver) => {\n    if (prop === \"on\") {\n      return (eventName: string, callback: Function) => {\n        LISTENERS[eventName] = callback;\n      };\n    }\n\n    if (typeof prop === \"string\") {\n      return (arg: unknown) => {\n        const { send_main_command } = Host.getFunctions() as any;\n        let msg: string;\n        msg = JSON.stringify({ [camelToPascal(prop)]: arg ?? [] });\n        console.log(\"parsed ext command msg\", msg, prop, arg);\n        const mem = Memory.fromString(msg);\n        const offset = send_main_command(mem.offset);\n        const response = Memory.find(offset).readString();\n        return JSON.parse(response);\n      };\n    }\n\n    return undefined;\n  },\n});\n\nexport function callListener(event: string, ...args: unknown[]) {\n  if (LISTENERS[event]) {\n    return Promise.resolve(LISTENERS[event](...args));\n  }\n  throw new Error(\"Not implemented\");\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA,IAAI,YAAsC,CAAC;AAE3C,SAAS,cAAc,cAAsB;AAE3C,SAAO,aAAa,OAAO,CAAC,EAAE,YAAY,IAAI,aAAa,MAAM,CAAC;AACpE;AAEO,IAAM,MAAoB,IAAI,MAAM,CAAC,GAAmB;AAAA,EAC7D,KAAK,CAAC,SAAS,MAAM,cAAc;AACjC,QAAI,SAAS,MAAM;AACjB,aAAO,CAAC,WAAmB,aAAuB;AAChD,kBAAU,SAAS,IAAI;AAAA,MACzB;AAAA,IACF;AAEA,QAAI,OAAO,SAAS,UAAU;AAC5B,aAAO,CAAC,QAAiB;AACvB,cAAM,EAAE,kBAAkB,IAAI,KAAK,aAAa;AAChD,YAAI;AACJ,cAAM,KAAK,UAAU,EAAE,CAAC,cAAc,IAAI,CAAC,GAAG,OAAO,CAAC,EAAE,CAAC;AACzD,gBAAQ,IAAI,0BAA0B,KAAK,MAAM,GAAG;AACpD,cAAM,MAAM,OAAO,WAAW,GAAG;AACjC,cAAM,SAAS,kBAAkB,IAAI,MAAM;AAC3C,cAAM,WAAW,OAAO,KAAK,MAAM,EAAE,WAAW;AAChD,eAAO,KAAK,MAAM,QAAQ;AAAA,MAC5B;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AACF,CAAC;AAEM,SAAS,aAAa,UAAkB,MAAiB;AAC9D,MAAI,UAAU,KAAK,GAAG;AACpB,WAAO,QAAQ,QAAQ,UAAU,KAAK,EAAE,GAAG,IAAI,CAAC;AAAA,EAClD;AACA,QAAM,IAAI,MAAM,iBAAiB;AACnC;",
  "names": []
}
